<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
                    
        <head><meta content="application/xhtml+xml; charset=utf-8" http-equiv="Content-Type"/>
            <meta content="application/xhtml+xml; charset=utf-8" name="content-type"/>
            <meta content="&#10;        &#10;    Introduction to Data Structures and Algorithms" name="title"/>
            <meta content="Christian Ullenboom" name="author"/>
            <meta content="Rheinwerk Publishing" name="publisher"/>
            <meta content="© 2023 by Rheinwerk Publishing Inc., Boston (MA)" name="copyright"/>
            <meta content="Java - The Comprehensive Guide - &#10;        &#10;    Introduction to Data Structures and Algorithms" name="description"/>
            <meta content="en" name="language"/>
            <title>
        
    Introduction to Data Structures and Algorithms</title>
            <link href="common/main.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:e0000000-0000-0000-0000-000030211834" name="Adept.expected.resource"/>
        </head>
    


                    <body class="office_us type_">
                        <div id="main">
        
        <h2 class="t2" id="h18.5">18.5    Creating a Stream
            <a class="indexanchor" id="i18_49"/>
        </h2>
        
        <p class="standard">The 
            <samp class="listingcharacter listingcharacter">java.util.stream</samp> package declares various types related to streams. At the center is a generically declared 
            <samp class="listingcharacter listingcharacter">Stream</samp>
         interface for object streams. A copy is always generated from a data source. Numerous stream generators are available.</p>
        
        <table class="standardtable" id="t18.1">
            
            <thead>
                
                <tr>
                    
                    <th class="tablehead tablecell_first top_border_cell">
                        
                        <p class="standard first-item last-item">Type</p>
                    
                    </th>
                    
                    <th class="tablehead tablecell_middle top_border_cell">
                        
                        <p class="standard first-item last-item">Method</p>
                    
                    </th>
                    
                    <th class="tablehead tablecell_last top_border_cell">
                        
                        <p class="standard first-item last-item">Return</p>
                    
                    </th>
                
                </tr>
            
            </thead>
            
            <tbody>
                
                <tr>
                    
                    <td class="tablecell tablecell_first top_border_cell">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Collection&lt;E&gt;</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_middle top_border_cell">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">stream()</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last top_border_cell">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;E&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr class="light">
                    
                    <td class="tablecell tablecell_first">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Arrays</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">stream(T[] array)</samp>
                         (static)</p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;T&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr>
                    
                    <td class="tablecell tablecell_first"/>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">stream(T[] array, int start, int end)</samp>
                         (static)</p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;T&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr class="light">
                    
                    <td class="tablecell tablecell_first">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">empty()</samp>
                         (static)</p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;T&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr>
                    
                    <td class="tablecell tablecell_first"/>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">of(T… values)</samp>
                         (static)</p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;T&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr class="light">
                    
                    <td class="tablecell tablecell_first"/>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">of(T value)</samp>
                         (static)</p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;T&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr>
                    
                    <td class="tablecell tablecell_first"/>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">generate(Supplier&lt;T&gt; s)</samp>
                        (static)</p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;T&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr class="light">
                    
                    <td class="tablecell tablecell_first"/>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">iterate(T seed, <br/>UnaryOperator&lt;T&gt; f)</samp>
                        (static)</p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;T&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr>
                    
                    <td class="tablecell tablecell_first"/>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">iterate(T seed, Predicate&lt;? super T&gt; hasNext, UnaryOperator&lt;T&gt; next)</samp>
                         (static)</p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;T&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr class="light">
                    
                    <td class="tablecell tablecell_first"/>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">ofNullable(T t)</samp>
                         (static)</p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;T&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr>
                    
                    <td class="tablecell tablecell_first">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Optional&lt;T&gt;</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream()</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;T&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr class="light">
                    
                    <td class="tablecell tablecell_first">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Scanner</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">tokens()</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;String&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr>
                    
                    <td class="tablecell tablecell_first">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">String</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">lines()</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;String&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr class="light">
                    
                    <td class="tablecell tablecell_first">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Files</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">lines(Path path)</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;String&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr>
                    
                    <td class="tablecell tablecell_first"/>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">lines(Path path, Charset cs)</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;String&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr class="light">
                    
                    <td class="tablecell tablecell_first"/>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">
                                <a id="p948"/>
                            list(Path dir)</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;Path&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr>
                    
                    <td class="tablecell tablecell_first"/>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">walk(Path start, FileVisitOption… options)</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;Path&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr class="light">
                    
                    <td class="tablecell tablecell_first"/>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">walk(Path start, int maxDepth, FileVisitOption… options)</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;Path&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr>
                    
                    <td class="tablecell tablecell_first"/>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">find(Path start, int maxDepth, BiPredicate&lt;Path,BasicFileAttributes&gt; matcher, FileVisitOption… options)</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;Path&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr class="light">
                    
                    <td class="tablecell tablecell_first">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">BufferedReader</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">lines()</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;String&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr>
                    
                    <td class="tablecell tablecell_first">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Pattern</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">splitAsStream(CharSequence input)</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;String&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr class="light">
                    
                    <td class="tablecell tablecell_first">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">ZipFile</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">stream()</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;? extends ZipEntry&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr>
                    
                    <td class="tablecell tablecell_first">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">JarFile</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">stream()</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;JarEntry&gt;</samp>
                        </p>
                    
                    </td>
                
                </tr>
                
                <tr class="light">
                    
                    <td class="tablecell tablecell_first"/>
                    
                    <td class="tablecell tablecell_middle">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Stream&lt;JarEntry&gt;</samp>
                        </p>
                    
                    </td>
                    
                    <td class="tablecell tablecell_last">
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">versionedStream() </samp>
                        </p>
                    
                    </td>
                
                </tr>
            
            </tbody>
        
        </table>
        
        <p class="caption "><b>Table 18.1</b>    
            Methods That Provide Stream Instances</p>
        
        <p class="standard">The 
            <samp class="listingcharacter listingcharacter">Stream.empty()</samp>
         method returns a stream without elements, as expected.</p>
        
        
            
            <h3 class="t3" id="h18.5.1">18.5.1    Stream.of*(…)</h3>
            
            <p class="standard">
                <samp class="listingcharacter listingcharacter">Stream</samp> has some factory methods for new streams, such as 
                <samp class="listingcharacter listingcharacter">of(...)</samp>. Several instance methods of other classes may also provide streams. The 
                <samp class="listingcharacter listingcharacter">of(...)</samp> methods are implemented as static interface methods of 
                <samp class="listingcharacter listingcharacter">Stream</samp>, and 
                <samp class="listingcharacter listingcharacter">of(T... values)</samp> is just a facade for 
                <samp class="listingcharacter listingcharacter">Arrays.stream(values)</samp>. The method 
                <samp class="listingcharacter listingcharacter">static &lt;T&gt; Stream&lt;T&gt; ofNullable(T t)</samp>, if 
                <samp class="listingcharacter listingcharacter">t == null</samp>, returns an empty stream, and if 
                <samp class="listingcharacter listingcharacter">t != null</samp>, it returns a stream with exactly the element 
                <samp class="listingcharacter listingcharacter">t</samp>
            . This method is useful for partial streams that are to be integrated.</p>
            
            <div class="box box_standard">
                
                <h6 class="boxheading"><span class="box_icon">[eg]  </span>Example</h6>
                
                <p class="standard first">The following example produces a stream from the given integers, removes their signs, sorts the result, and then outputs the result:</p>
                
                <div class="listing  last_item" id="l_none_18625"><pre>
                    <span class="bold"><span class="">Stream.</span><span class="">of</span></span><span class="">( -</span><span class="">4</span><span class="">, </span><span class="">1</span><span class="">, -</span><span class="">2</span><span class="">, </span><span class="">3</span><span class=""> )</span><br/>      .<span class="">map</span><span class="">( Math::abs )</span><br/>      .<span class="">sorted</span><span class="">()</span><br/>      .<span class="">forEach</span><span class="">( System.out::println );</span><span class=""> // 1 2 3 </span><span class="">4</span><span class=""/></pre></div>
            
            </div>
        
        
        
        
            
            <h3 class="t3" id="h18.5.2">18.5.2    
                <a id="p949"/>
            Stream.generate(…)</h3>
            
            <p class="standard">
                <samp class="listingcharacter listingcharacter">generate(...)</samp> produces elements from a 
                <samp class="listingcharacter listingcharacter">Supplier</samp>
            ; the stream is infinite.</p>
            
            <div class="box box_standard">
                
                <h6 class="boxheading"><span class="box_icon">[eg]  </span>Examples</h6>
                
                <p class="standard first">The following example creates a stream of Fibonacci numbers
                    <span class="footnote_anchor"><a href="footnotes.html#ftn-fn18_05" id="fn18_05">[ 223 ]</a></span>
                :</p>
                
                <div class="listing " id="l_none_18635"><pre><span class="">class</span><span class=""> FibSupplier </span><span class="">implements</span><span class=""> Supplier</span><span class="">&lt;</span><span class="">BigInteger</span><span class="">&gt;</span><span class=""> </span><span class="">{</span><span class=""><br/></span>  <span class="">private</span><span class=""> </span><span class="">final</span><span class=""> Queue</span><span class="">&lt;</span><span class="">BigInteger</span><span class="">&gt;</span><span class=""> fibs </span><span class="">=</span><span class=""><br/></span>      <span class="">new</span><span class=""> LinkedList</span><span class="">&lt;&gt;(</span><span class=""> Arrays</span><span class="">.</span><span class="">asList</span><span class="">(</span><span class=""> BigInteger</span><span class="">.</span><span class="">ZERO</span><span class="">,</span><span class=""> BigInteger</span><span class="">.</span><span class="">ONE </span><span class="">)</span><span class=""> </span><span class="">);</span><span class=""><br/></span>  <span class="">@Override</span><span class=""> </span><span class="">public</span><span class=""> BigInteger </span><span class="">get</span><span class="">()</span><span class=""> </span><span class="">{</span><span class=""><br/></span>    fibs<span class="">.</span><span class="">offer</span><span class="">(</span><span class=""> fibs</span><span class="">.</span><span class="">remove</span><span class="">().</span><span class="">add</span><span class="">(</span><span class=""> fibs</span><span class="">.</span><span class="">peek</span><span class="">()</span><span class=""> </span><span class="">)</span><span class=""> </span><span class="">);</span><span class=""><br/></span>    <span class="">return</span><span class=""> fibs</span><span class="">.</span><span class="">peek</span><span class="">();</span><span class=""><br/></span>  <span class="">}</span><span class=""><br/></span><span class="">};</span><span class=""><br/></span>Stream<span class="">.</span>
                    <span class="bold"><span class="">generate</span><span class="">( </span><span class="">new</span><span class=""> </span><span class="">FibSupplier</span><span class="">() )</span></span><br/>      .<span class="">limit</span><span class="">( </span><span class="">1000</span><span class=""> ).</span><span class="">forEach</span><span class="">( System.out::println );</span><span class=""/></pre></div>
                
                <p class="standard last">This implementation doesn’t use a lambda expression but instead an old-fashioned class implementation since we need to remember the last two elements to determine the next element in the Fibonacci sequences. Thus, the implementation stores a 
                    <samp class="listingcharacter listingcharacter">LinkedList</samp> that’s used as a 
                    <samp class="listingcharacter listingcharacter">Queue</samp>. When requesting a new Fibonacci number, we delete the first element from the queue (the head element) so that the second one slips in, and add the value to the remembered head element, resulting in the new Fibonacci number. We append the new element to the end in the second step and return it. Parallel access isn’t allowed. The stream is initially infinitely large but is then limited to 1,000 elements via 
                    <samp class="listingcharacter listingcharacter">limit(...)</samp>
                .</p>
            
            </div>
        
        
        
        
            
            <h3 class="t3" id="h18.5.3">18.5.3    Stream.iterate(…)</h3>
            
            <p class="standard">The two static 
                <samp class="listingcharacter listingcharacter">iterate(...)</samp> methods generate a stream from a start value and a function that produces the next element. In 
                <samp class="listingcharacter listingcharacter">iterate(T seed, UnaryOperator&lt;T&gt; f)</samp> the stream is infinite; in the second method 
                <samp class="listingcharacter listingcharacter">iterate(..., Predicate&lt;? super T&gt; hasNext, ...)</samp>, a satisfied predicate terminates the stream and is reminiscent of a classic 
                <samp class="listingcharacter listingcharacter">for</samp> loop. Termination via a predicate is quite flexible because, with the first 
                <samp class="listingcharacter listingcharacter">iterate(...)</samp> method, the stream is infinite and thus is often followed by 
                <samp class="listingcharacter listingcharacter">limit(...)</samp> or 
                <samp class="listingcharacter listingcharacter">takeWhile(</samp>
            ...) to limit the elements.</p>
            
            <div class="box box_standard">
                
                <h6 class="boxheading"><span class="box_icon">[eg]  </span>Example 1</h6>
                
                <p class="standard first">The following example produces several permutations of a string:</p>
                
                <div class="listing " id="l_none_18646"><pre>UnaryOperator<span class="">&lt;</span><span class="">String</span><span class="">&gt;</span><span class=""> shuffleOp </span><span class="">=</span><span class=""> s </span><span class="">-&gt;</span><span class=""> </span><span class="">{</span><span class=""><br/></span>  <span class="">char</span><span class="">[]</span><span class=""> chars </span><span class="">=</span><span class=""> s</span><span class="">.</span><span class="">toCharArray</span><span class="">();</span><span class=""><br/></span>  <span class="">for</span><span class=""> </span><span class="">(</span><span class=""> </span><span class="">int</span><span class=""> index </span><span class="">=</span><span class=""> chars</span><span class="">.</span><span class="">length </span><span class="">-</span><span class=""> </span><span class="">1</span><span class="">;</span><span class=""> index </span><span class="">&gt;</span><span class=""> </span><span class="">0</span><span class="">;</span><span class=""> index</span><span class="">--</span><span class=""> </span><span class="">)</span><span class=""> </span><span class="">{</span><span class=""><br/></span>
                    <a id="p950"/>    <span class="">int</span><span class=""> rndIndex </span><span class="">=</span><span class=""> ThreadLocalRandom</span><span class="">.</span><span class="">current</span><span class="">().</span><span class="">nextInt</span><span class="">(</span><span class=""> index </span><span class="">+</span><span class=""> </span><span class="">1</span><span class=""> </span><span class="">);</span><span class=""><br/></span>    <span class="">if</span><span class=""> </span><span class="">(</span><span class=""> index </span><span class="">==</span><span class=""> rndIndex </span><span class="">)</span><span class=""> </span><span class="">continue</span><span class="">;</span><span class=""><br/></span>    <span class="">char</span><span class=""> c </span><span class="">=</span><span class=""> chars</span><span class="">[</span><span class=""> rndIndex </span><span class="">];</span><span class=""><br/></span>    chars<span class="">[</span><span class=""> rndIndex </span><span class="">]</span><span class=""> </span><span class="">=</span><span class=""> chars</span><span class="">[</span><span class=""> index </span><span class="">];</span><span class=""><br/></span>    chars<span class="">[</span><span class=""> index </span><span class="">]</span><span class=""> </span><span class="">=</span><span class=""> c</span><span class="">;</span><span class=""><br/></span>  <span class="">}</span><span class=""><br/></span>  <span class="">return</span><span class=""> </span><span class="">new</span><span class=""> </span><span class="">String</span><span class="">(</span><span class=""> chars </span><span class="">);</span><span class=""><br/></span><span class="">};</span><span class=""><br/></span><span class="">String</span><span class=""> text </span><span class="">=</span><span class=""> "He's a very naughty boy</span><span class="">!</span><span class=""> Now</span><span class="">,</span><span class=""> go away</span><span class="">!</span><span class="">"</span><span class="">;</span><span class=""><br/></span>Stream<span class="">.</span>
                    <span class="bold"><span class="">iterate</span><span class="">( text, shuffleOp )</span></span>.<span class="">limit</span><span class="">( </span><span class="">10</span><span class=""> ).</span><span class="">forEach</span><span class="">( System.out::println );</span><span class=""/></pre></div>
                
                <p class="standard last">The random integers don’t come from a 
                    <samp class="listingcharacter listingcharacter">Random</samp> object this time, but from 
                    <samp class="listingcharacter listingcharacter">ThreadLocalRandom</samp>
                    <a class="indexanchor" id="i18_50"/>
                . This special class is connected to the current thread and can also provide single random numbers or a stream. With concurrency, this variant provides better performance.</p>
            
            </div>
            
            <div class="box box_standard">
                
                <h6 class="boxheading"><span class="box_icon">[eg]  </span>Example 2</h6>
                
                <p class="standard first">The following example creates an infinite stream of 
                    <samp class="listingcharacter listingcharacter">BigInteger</samp>
                 objects starting at 10,000,000 and continues in units until, with high probability, a prime number appears. Then, the stream ends at that point:</p>
                
                <div class="listing  last_item" id="l_none_18643"><pre>Predicate<span class="">&lt;</span><span class="">BigInteger</span><span class="">&gt;</span><span class=""> isNotPrime </span><span class="">=</span><span class=""> i </span><span class="">-&gt;</span><span class=""> </span><span class="">!</span><span class=""> i</span><span class="">.</span><span class="">isProbablePrime</span><span class="">(</span><span class=""> </span><span class="">10</span><span class=""> </span><span class="">);</span><span class=""><br/></span>UnaryOperator<span class="">&lt;</span><span class="">BigInteger</span><span class="">&gt;</span><span class=""> incBigInt </span><span class="">=</span><span class=""> i </span><span class="">-&gt;</span><span class=""> i</span><span class="">.</span><span class="">add</span><span class="">(</span><span class=""> BigInteger</span><span class="">.</span><span class="">ONE </span><span class="">);</span><span class=""><br/></span>Stream<span class="">.</span>
                    <span class="bold"><span class="">iterate</span><span class="">( BigInteger.</span><span class="">valueOf</span><span class="">( 10_000_000 ), isNotPrime, incBigInt )</span></span><br/>      .<span class="">forEach</span><span class="">( System.out::println );</span><span class=""/></pre></div>
            
            </div>
        
        
        
        
            
            <h3 class="t3" id="h18.5.4">18.5.4    Parallel or Sequential Streams</h3>
            
            <p class="standard">A stream can be parallel or sequential. In other words, threads can perform certain operations concurrently, such as searching for an item. 
                <samp class="listingcharacter listingcharacter">Stream</samp> returns 
                <samp class="listingcharacter listingcharacter">true</samp> via 
                <samp class="listingcharacter listingcharacter">isParallel()</samp>
             if a stream performs operations concurrently.</p>
            
            <p class="standard">All 
                <samp class="listingcharacter listingcharacter">Collection</samp> data structures can provide a potentially concurrent stream using the 
                <samp class="listingcharacter listingcharacter">parallelStream()</samp>
             method.</p>
            
            <table class="standardtable" id="t18.2">
                
                <thead>
                    
                    <tr>
                        
                        <th class="tablehead tablecell_first top_border_cell">
                            
                            <p class="standard first-item last-item">Type</p>
                        
                        </th>
                        
                        <th class="tablehead tablecell_middle top_border_cell">
                            
                            <p class="standard first-item last-item">Method</p>
                        
                        </th>
                        
                        <th class="tablehead tablecell_last top_border_cell">
                            
                            <p class="standard first-item last-item">Return</p>
                        
                        </th>
                    
                    </tr>
                
                </thead>
                
                <tbody>
                    
                    <tr>
                        
                        <td class="tablecell tablecell_first top_border_cell">
                            
                            <p class="standard first-item last-item">
                                <samp class="listingcharacter listingcharacter">Collection</samp>
                            </p>
                        
                        </td>
                        
                        <td class="tablecell tablecell_middle top_border_cell">
                            
                            <p class="standard first-item last-item">
                                <samp class="listingcharacter listingcharacter">parallelStream()</samp>
                            </p>
                        
                        </td>
                        
                        <td class="tablecell tablecell_last top_border_cell">
                            
                            <p class="standard first-item last-item">
                                <samp class="listingcharacter listingcharacter">Stream&lt;E&gt;</samp>
                            </p>
                        
                        </td>
                    
                    </tr>
                    
                    <tr class="light">
                        
                        <td class="tablecell tablecell_first">
                            
                            <p class="standard first-item last-item">
                                <samp class="listingcharacter listingcharacter">Collection</samp>
                            </p>
                        
                        </td>
                        
                        <td class="tablecell tablecell_middle">
                            
                            <p class="standard first-item last-item">
                                <samp class="listingcharacter listingcharacter">stream()</samp>
                            </p>
                        
                        </td>
                        
                        <td class="tablecell tablecell_last">
                            
                            <p class="standard first-item last-item">
                                <samp class="listingcharacter listingcharacter">Stream&lt;E&gt;</samp>
                            </p>
                        
                        </td>
                    
                    </tr>
                
                </tbody>
            
            </table>
            
            <p class="caption "><b>Table 18.2</b>    
            Querying Parallel and Non-Parallel Streams from Each Collection</p>
            
            <p class="standard">Any parallel stream can be converted to a sequential stream using the 
                <samp class="listingcharacter listingcharacter">Stream</samp> method, 
                <samp class="listingcharacter listingcharacter">sequential()</samp>. Parallel streams use the fork-and-join framework internally, but not 
                <a id="p951"/>
            every stream should automatically be parallel. (Parallelization doesn’t necessarily lead to performance improvements.) For example, if parallelization isn’t possible, using threads serves little purpose.</p>
        
        
    
    </div><p class="signatur"/>
                    </body>
                </html>