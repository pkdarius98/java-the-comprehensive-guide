<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
                    
        <head><meta content="application/xhtml+xml; charset=utf-8" http-equiv="Content-Type"/>
            <meta content="application/xhtml+xml; charset=utf-8" name="content-type"/>
            <meta content="&#10;        &#10;    Bits and Bytes, Mathematics and Money" name="title"/>
            <meta content="Christian Ullenboom" name="author"/>
            <meta content="Rheinwerk Publishing" name="publisher"/>
            <meta content="© 2023 by Rheinwerk Publishing Inc., Boston (MA)" name="copyright"/>
            <meta content="Java - The Comprehensive Guide - &#10;        &#10;    Bits and Bytes, Mathematics and Money" name="description"/>
            <meta content="en" name="language"/>
            <title>
        
    Bits and Bytes, Mathematics and Money</title>
            <link href="common/main.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:e0000000-0000-0000-0000-000030211834" name="Adept.expected.resource"/>
        </head>
    


                    <body class="office_us type_">
                        <div id="main">
        
        <h2 class="t2" id="h21.5">21.5    Random Numbers:
            <a class="indexanchor" id="i21_107"/>
         Random, ThreadLocalRandom, and SecureRandom</h2>
        
        <p class="standard">The 
            <samp class="listingcharacter listingcharacter">Math</samp> class provides a simple method for random numbers: 
            <samp class="listingcharacter listingcharacter">random()</samp>
        . Internally, however, this method based on a different class that you can also use directly, thus enabling you to ask for more than just random numbers between 0 and 1.</p>
        
        <p class="standard">
            <a id="p1047"/>The usual random numbers of Java are actually 
            <span class="italic">pseudo-random numbers</span>
            <a class="indexanchor" id="i21_108"/>
         because they are generated by a mathematical algorithm. Good “random values” are repeated only after exceedingly long sequences, have no obvious context, and are generated quickly. Perfect random numbers would never be predictable: The probability for each number would always be the same—regardless of the preceding values—and the sequences would never be repeated.</p>
        
        
            
            <h3 class="t3" id="h21.5.1">21.5.1    The Random Class</h3>
            
            <p class="standard">The 
                <samp class="listingcharacter listingcharacter">Random</samp> class in the 
                <samp class="listingcharacter listingcharacter">java.util </samp>package implements a generator for pseudo-random numbers. Unlike 
                <samp class="listingcharacter listingcharacter">Math.random()</samp>, 
                <samp class="listingcharacter listingcharacter">Random</samp> doesn’t provide any static functions but does provide a set of 
                <samp class="listingcharacter listingcharacter">next*(...)</samp> methods. The static function 
                <samp class="listingcharacter listingcharacter">Math.random()</samp> uses a 
                <samp class="listingcharacter listingcharacter">Random</samp>
             object internally.</p>
            
            
                
                <h4 class="t4" id="h21.5.1.1">Creating Random Objects with a Seed</h4>
                
                <p class="standard">Every 
                    <samp class="listingcharacter listingcharacter">Random</samp> object needs an initial value for the calculation. The initial value for each random number is a 48-bit seed. “Seed
                    <a class="indexanchor" id="i21_109"/>” indicates that, in the generation of random numbers, as with plants, a seed leads to offspring. From this initial value, the random number generator then determines the following numbers by linear
                    <a class="indexanchor" id="i21_110"/>
                    <a class="indexanchor" id="i21_111"/>
                 congruences. (Thus, the numbers aren’t really random but instead obey a mathematical procedure.)</p>
                
                <p class="standard">At the beginning, you’ll need an instance of the 
                    <samp class="listingcharacter listingcharacter">Random</samp> class. This instance is initialized with a random value (data type 
                    <samp class="listingcharacter listingcharacter">long</samp>), which is then used for the subsequent calculations. This initial value shapes the entire sequence of generated random numbers, although how the sequence behaves isn’t obvious. One thing is certain: Two 
                    <samp class="listingcharacter listingcharacter">Random</samp> objects created with the same initial values also return the same sequence of random numbers, namely: If the seed is the same, of course, the sequence of random numbers is always the same. For testing, this similarity isn’t bad at all. The parameterless constructor of 
                    <samp class="listingcharacter listingcharacter">Random</samp> initializes the start value with the sum of a magic start value and 
                    <samp class="listingcharacter listingcharacter">System.nanoTime()</samp>
                .</p>
                
                <div class="listing " id="l_none_21692"><pre><span class="">class</span><span class=""> </span>
                    <span class="bold"><span class="">Random</span></span><br/><span class="">implements</span><span class=""> RandomGenerator, Serializable </span><span class=""/></pre></div>
                
                <ul>
                    
                    <li>
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Random()</samp><br/>Creates a new
                            <a class="indexanchor" id="i21_112"/>
                         random number generator.</p>
                    
                    </li>
                    
                    <li>
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">Random(long seed)</samp><br/>Creates a new random number generator and uses the 
                            <samp class="listingcharacter listingcharacter">seed</samp>
                            <a class="indexanchor" id="i21_113"/>
                         parameter as a start value.</p>
                    
                    </li>
                    
                    <li>
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">void setSeed(long seed)</samp><br/>Resets the seed. The generator subsequently behaves in the same way as a generator freshly created with this seed value.</p>
                    
                    </li>
                
                </ul>
            
            
            
            
                
                <h4 class="t4" id="h21.5.1.2">
                    <a id="p1048"/>
                Generating Single Random Numbers</h4>
                
                <p class="standard">The 
                    <samp class="listingcharacter listingcharacter">Random</samp> class generates random numbers for four different data types: 
                    <samp class="listingcharacter listingcharacter">int</samp> (32 bit), 
                    <samp class="listingcharacter listingcharacter">long</samp> (64 bit), 
                    <samp class="listingcharacter listingcharacter">double</samp>, and 
                    <samp class="listingcharacter listingcharacter">float</samp>
                . Four methods are available for this purpose:</p>
                
                <ul>
                    
                    <li>
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">int nextInt()</samp>
                        </p>
                    
                    </li>
                    
                    <li>
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">long nextLong()</samp><br/>Returns the next pseudo-random number from the entire value range (i.e., between 
                            <samp class="listingcharacter listingcharacter">Integer.MIN_VALUE</samp> and 
                            <samp class="listingcharacter listingcharacter">Integer.MAX_VALUE</samp> or between 
                            <samp class="listingcharacter listingcharacter">Long.MIN_VALUE</samp> and 
                            <samp class="listingcharacter listingcharacter">Long.MAX_VALUE</samp>
                        ).</p>
                    
                    </li>
                    
                    <li>
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">float nextFloat()</samp>
                        </p>
                    
                    </li>
                    
                    <li>
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">double nextDouble()</samp><br/>Returns the next pseudo-random number between 0.0 and 1.0.</p>
                    
                    </li>
                    
                    <li>
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">int nextInt(int range)</samp><br/>Returns an 
                            <samp class="listingcharacter listingcharacter">int pseudo-random number</samp> in the range 0 to 
                            <samp class="listingcharacter listingcharacter">range</samp>
                        .</p>
                    
                    </li>
                
                </ul>
                
                <p class="standard">The 
                    <samp class="listingcharacter listingcharacter">Random</samp> class has a special method for generating a series of random numbers all at once: the 
                    <samp class="listingcharacter listingcharacter">nextBytes(byte[])</samp>
                 method. The parameter is a byte array, which is completely filled with random numbers.</p>
                
                <p class="standard">All methods for generating random numbers are based on the 
                    <samp class="listingcharacter listingcharacter">next(int bits)</samp> method. This method is implemented in 
                    <samp class="listingcharacter listingcharacter">Random</samp>, but due to its 
                    <samp class="listingcharacter listingcharacter">protected</samp> visibility, the method is only visible from an inheriting class. Subclasses are possible because 
                    <samp class="listingcharacter listingcharacter">Random</samp>
                 is a normal public non-final class.</p>
            
            
            
            
                
                <h4 class="t4" id="h21.5.1.3">Pseudo-Random Numbers in the Normal Distribution*</h4>
                
                <p class="standard">Via a special method, you can obtain random numbers that satisfy a normal distribution
                    <a class="indexanchor" id="i21_114"/>: 
                    <samp class="listingcharacter listingcharacter">nextGaussian()</samp>. This method works internally according to the
                    <a class="indexanchor" id="i21_115"/> polar method and generates two normally distributed numbers from two independent pseudo-random numbers. The midpoint is 0, and the standard deviation is 1. The values returned by 
                    <samp class="listingcharacter listingcharacter">nextGaussian()</samp> are 
                    <samp class="listingcharacter listingcharacter">double</samp>
                 numbers and often approximate 0. Larger numbers are rather rare.</p>
                
                <div class="listing " id="l_none_21706"><pre><span class="">class</span><span class=""> java</span><span class="">.</span><span class="">util</span><span class="">.</span>
                    <span class="bold">Random</span><br/><span class="">implements</span><span class=""> Serializable </span><span class=""/></pre></div>
                
                <ul>
                    
                    <li>
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">double nextGaussian()</samp><br/>Returns the nearest random number in a Gaussian normal distribution
                            <a class="indexanchor" id="i21_116"/>
                            <a class="indexanchor" id="i21_117"/>
                         with 0.0 as the midpoint and a standard deviation of 1.0.</p>
                    
                    </li>
                
                </ul>
            
            
            
            
                
                <h4 class="t4" id="h21.5.1.4">Generating a Stream of Random Numbers*</h4>
                
                <p class="standard">If several random numbers are required, a loop with repeated calls of 
                    <samp class="listingcharacter listingcharacter">next*()</samp> isn’t necessary. Instead, two varieties of methods in 
                    <samp class="listingcharacter listingcharacter">Random</samp>
                 return a bunch of random numbers.</p>
                
                <p class="standard">
                    <a id="p1049"/>
                The first approach uses an array:</p>
                
                <ul>
                    
                    <li>
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">void nextBytes(byte[] bytes)</samp><br/>Fills the 
                            <samp class="listingcharacter listingcharacter">bytes</samp>
                         array with random bytes.</p>
                    
                    </li>
                
                </ul>
                
                <p class="standard">Other methods provide a stream of random numbers:</p>
                
                <ul>
                    
                    <li>
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">IntStream ints(…)</samp>
                        </p>
                    
                    </li>
                    
                    <li>
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">LongStream longs(…)</samp>
                        </p>
                    
                    </li>
                    
                    <li>
                        
                        <p class="standard first-item last-item">
                            <samp class="listingcharacter listingcharacter">DoubleStream doubles(…)</samp>
                        </p>
                    
                    </li>
                
                </ul>
                
                <div class="box box_standard">
                    
                    <h6 class="boxheading"><span class="box_icon">[eg]  </span>Example</h6>
                    
                    <p class="standard first">The following example returns ten random numbers that are probably prime numbers:</p>
                    
                    <div class="listing  last_item" id="l_none_21726"><pre>LongStream stream <span class="">=</span><span class=""> </span><span class="">new</span><span class=""> </span><span class="">Random</span><span class="">().</span><span class="">longs</span><span class="">()</span><span class=""><br/></span>                       <span class="">.</span><span class="">filter</span><span class="">(</span><span class=""> v </span><span class="">-&gt;</span><span class=""> BigInteger</span><span class="">.</span><span class="">valueOf</span><span class="">(</span><span class=""> v </span><span class="">).</span><span class="">isProbablePrime</span><span class="">(</span><span class="">5</span><span class="">)</span><span class=""> </span><span class="">);</span><span class=""><br/></span>stream<span class="">.</span><span class="">limit</span><span class="">(</span><span class=""> </span><span class="">10</span><span class=""> </span><span class="">).</span><span class="">forEach</span><span class="">(</span><span class=""> System</span><span class="">.</span><span class="">out</span><span class="">::</span><span class="">println </span><span class="">)</span><span class="">;</span></pre></div>
                
                </div>
                
                <p class="standard">The methods 
                    <samp class="listingcharacter listingcharacter">ints(...)</samp>, 
                    <samp class="listingcharacter listingcharacter">longs(...)</samp>, and 
                    <samp class="listingcharacter listingcharacter">doubles(...)</samp> come in four flavors, as shown in 
                    <span class="crossreference "><a href="21_005.html#t21.13">Table 21.13</a></span>
                .</p>
                
                <table class="standardtable" id="t21.13">
                    
                    <thead>
                        
                        <tr>
                            
                            <th class="tablehead tablecell_first top_border_cell">
                                
                                <p class="standard first-item last-item">Parameterization</p>
                            
                            </th>
                            
                            <th class="tablehead tablecell_last top_border_cell">
                                
                                <p class="standard first-item last-item">Explanation</p>
                            
                            </th>
                        
                        </tr>
                    
                    </thead>
                    
                    <tbody>
                        
                        <tr>
                            
                            <td class="tablecell tablecell_first top_border_cell">
                                
                                <p class="standard first-item last-item">
                                    <samp class="listingcharacter listingcharacter">IntStream ints()</samp>
                                </p>
                            
                            </td>
                            
                            <td class="tablecell tablecell_last top_border_cell tablecell_has_rowspan" rowspan="3">
                                
                                <p class="standard first-item last-item">Returns an infinite stream of random numbers in the entire range of values of the primitives.</p>
                            
                            </td>
                        
                        </tr>
                        
                        <tr class="light">
                            
                            <td class="tablecell tablecell_first tablecell_last">
                                
                                <p class="standard first-item last-item">
                                    <samp class="listingcharacter listingcharacter">LongStream longs()</samp>
                                </p>
                            
                            </td>
                        
                        </tr>
                        
                        <tr>
                            
                            <td class="tablecell tablecell_first tablecell_last">
                                
                                <p class="standard first-item last-item">
                                    <samp class="listingcharacter listingcharacter">DoubleStream doubles()</samp>
                                </p>
                            
                            </td>
                        
                        </tr>
                        
                        <tr class="light">
                            
                            <td class="tablecell tablecell_first">
                                
                                <p class="standard first-item last-item">
                                    <samp class="listingcharacter listingcharacter">ints(long streamSize)</samp>
                                </p>
                            
                            </td>
                            
                            <td class="tablecell tablecell_last tablecell_has_rowspan" rowspan="3">
                                
                                <p class="standard first-item last-item">Returns a stream with 
                                    <samp class="listingcharacter listingcharacter">streamSize</samp>
                                 random numbers.</p>
                            
                            </td>
                        
                        </tr>
                        
                        <tr>
                            
                            <td class="tablecell tablecell_first tablecell_last">
                                
                                <p class="standard first-item last-item">
                                    <samp class="listingcharacter listingcharacter">longs(long streamSize)</samp>
                                </p>
                            
                            </td>
                        
                        </tr>
                        
                        <tr class="light">
                            
                            <td class="tablecell tablecell_first tablecell_last">
                                
                                <p class="standard first-item last-item">
                                    <samp class="listingcharacter listingcharacter">doubles(long streamSize)</samp>
                                </p>
                            
                            </td>
                        
                        </tr>
                        
                        <tr>
                            
                            <td class="tablecell tablecell_first">
                                
                                <p class="standard first-item last-item">
                                    <samp class="listingcharacter listingcharacter">ints(int randomNumberOrigin, <br/>int randomNumberBound)</samp>
                                </p>
                            
                            </td>
                            
                            <td class="tablecell tablecell_last tablecell_has_rowspan" rowspan="3">
                                
                                <p class="standard first-item last-item">Returns an infinite stream of random numbers with values in the range from 
                                    <samp class="listingcharacter listingcharacter">randomNumberOrigin</samp> (inclusive) to 
                                    <samp class="listingcharacter listingcharacter">randomNumberBound</samp>
                                 (exclusive).</p>
                            
                            </td>
                        
                        </tr>
                        
                        <tr class="light">
                            
                            <td class="tablecell tablecell_first tablecell_last">
                                
                                <p class="standard first-item last-item">
                                    <samp class="listingcharacter listingcharacter">longs(long randomNumberOrigin, <br/>long randomNumberBound)</samp>
                                </p>
                            
                            </td>
                        
                        </tr>
                        
                        <tr>
                            
                            <td class="tablecell tablecell_first tablecell_last">
                                
                                <p class="standard first-item last-item">
                                    <samp class="listingcharacter listingcharacter">doubles(double randomNumberOrigin, <br/>double randomNumberBound)</samp>
                                </p>
                            
                            </td>
                        
                        </tr>
                        
                        <tr class="light">
                            
                            <td class="tablecell tablecell_first">
                                
                                <p class="standard first-item last-item">
                                    <samp class="listingcharacter listingcharacter"><a id="p1050"/>ints(long streamSize, int <br/>randomNumberOrigin, int <br/>randomNumberBound)</samp>
                                </p>
                            
                            </td>
                            
                            <td class="tablecell tablecell_last tablecell_has_rowspan" rowspan="3">
                                
                                <p class="standard first-item last-item">Returns a stream with 
                                    <samp class="listingcharacter listingcharacter">streamSize</samp> random numbers with values in the range from 
                                    <samp class="listingcharacter listingcharacter">randomNumberOrigin</samp> (inclusive) to 
                                    <samp class="listingcharacter listingcharacter">randomNumberBound</samp>
                                 (exclusive).</p>
                            
                            </td>
                        
                        </tr>
                        
                        <tr>
                            
                            <td class="tablecell tablecell_first tablecell_last">
                                
                                <p class="standard first-item last-item">
                                    <samp class="listingcharacter listingcharacter">longs(long streamSize, long <br/>randomNumberOrigin, long <br/>randomNumberBound)</samp>
                                </p>
                            
                            </td>
                        
                        </tr>
                        
                        <tr class="light">
                            
                            <td class="tablecell tablecell_first tablecell_last">
                                
                                <p class="standard first-item last-item">
                                    <samp class="listingcharacter listingcharacter">doubles(long streamSize, double <br/>randomNumberOrigin, double <br/>randomNumberBound)</samp>
                                </p>
                            
                            </td>
                        
                        </tr>
                    
                    </tbody>
                
                </table>
                
                <p class="caption "><b>Table 21.13</b>    
            Stream Methods of the Random Class</p>
                
                <div class="box box_standard">
                    
                    <h6 class="boxheading"><span class="box_icon">[eg]  </span>Example</h6>
                    
                    <p class="standard first">The following example outputs five random floats in the range from 10 to 20:</p>
                    
                    <div class="listing  last_item" id="l_none_21715"><pre><span class="">new</span><span class=""> </span><span class="">Random</span><span class="">().</span><span class="">doubles</span><span class="">(</span><span class="">5</span><span class="">,</span><span class=""> </span><span class="">10</span><span class="">,</span><span class=""> </span><span class="">20</span><span class="">).</span><span class="">forEach</span><span class="">(</span><span class=""> System</span><span class="">.</span><span class="">out</span><span class="">::</span><span class="">println </span><span class="">)</span><span class="">;</span></pre></div>
                
                </div>
            
            
        
        
        
        
            
            <h3 class="t3" id="h21.5.2">21.5.2    ThreadLocalRandom</h3>
            
            <p class="standard">The 
                <samp class="listingcharacter listingcharacter">ThreadLocalRandom</samp> class is a subclass of 
                <samp class="listingcharacter listingcharacter">Random</samp> and overrides central methods because 
                <samp class="listingcharacter listingcharacter">Random</samp> has a safeguard against concurrent access that 
                <samp class="listingcharacter listingcharacter">ThreadLocalRandom</samp> doesn’t have—an object of this class should only ever be used in the same thread. For this reason, a 
                <samp class="listingcharacter listingcharacter">ThreadLocalRandom</samp> isn’t created via 
                <samp class="listingcharacter listingcharacter">new</samp>
            , but a static factory method returns the object associated with the respective thread.</p>
            
            <div class="box box_standard">
                
                <h6 class="boxheading"><span class="box_icon">[eg]  </span>Example</h6>
                
                <p class="standard first">The following example determines two random numbers between 1 and 10:</p>
                
                <div class="listing  last_item" id="l_none_21734"><pre>Random threadLocalRandom <span class="">=</span><span class=""> ThreadLocalRandom</span><span class="">.</span><span class="">current</span><span class="">();</span><span class=""><br/></span>System<span class="">.</span><span class="">out</span><span class="">.</span><span class="">println</span><span class="">(</span><span class=""> threadLocalRandom</span><span class="">.</span><span class="">nextInt</span><span class="">(</span><span class=""> </span><span class="">1</span><span class="">,</span><span class=""> </span><span class="">10</span><span class=""> </span><span class="">+</span><span class=""> </span><span class="">1</span><span class=""> </span><span class="">)</span><span class=""> </span><span class="">);</span><span class=""><br/></span>System<span class="">.</span><span class="">out</span><span class="">.</span><span class="">println</span><span class="">(</span><span class=""> threadLocalRandom</span><span class="">.</span><span class="">nextInt</span><span class="">(</span><span class=""> </span><span class="">1</span><span class="">,</span><span class=""> </span><span class="">10</span><span class=""> </span><span class="">+</span><span class=""> </span><span class="">1</span><span class=""> </span><span class="">)</span><span class=""> </span><span class="">)</span><span class="">;</span></pre></div>
            
            </div>
        
        
        
        
            
            <h3 class="t3" id="h21.5.3">21.5.3    The SecureRandom Class*</h3>
            
            <p class="standard">The 
                <samp class="listingcharacter listingcharacter">Random</samp> class is in a dilemma: producing good and random numbers, on one hand, but also calculating quickly on the other hand. 
                <samp class="listingcharacter listingcharacter">Random</samp>
             doesn’t generate cryptographically decent numbers; for this scenario, the implementation would need more effort (which costs more time). Still, such advanced random numbers are not generally necessary in everyday life.</p>
            
            <p class="standard">
                <a id="p1051"/>Random numbers that are cryptographically more sound are provided by 
                <samp class="listingcharacter listingcharacter">java.security.SecureRandom</samp>, a subclass of 
                <samp class="listingcharacter listingcharacter">Random</samp>.
                <a class="indexanchor" id="i21_118"/> This subclass provides the same set of 
                <samp class="listingcharacter listingcharacter">next*(...)</samp> methods, but the quality of the random numbers is better. This isn’t due to 
                <samp class="listingcharacter listingcharacter">SecureRandom</samp> itself because the class doesn’t implement any algorithms, but to the referenced replaceable random number providers. An implementation is provided by 
                <samp class="listingcharacter listingcharacter">SecureRandom.getInstanceStrong()</samp> or by the parameterless constructor as well. In this case, however, the 
                <samp class="listingcharacter listingcharacter">SecureRandom</samp> object doesn’t necessarily have to be “strong,” that is, it doesn’t have to meet the highest cryptographic standards. The difference exists because 
                <samp class="listingcharacter listingcharacter">new SecureRandom().getAlgorithm().toString()</samp> returns SHA1PRNG, and 
                <samp class="listingcharacter listingcharacter">SecureRandom.getInstanceStrong().getAlgorithm().toString()</samp>
             returns Windows PRNG.</p>
        
        
    
    </div><p class="signatur"/>
                    </body>
                </html>